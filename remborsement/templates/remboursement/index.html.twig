{% extends 'base.html.twig' %}


{% block body %}
<tbody id="all">
          <a href="{{ path('addrapportfront') }}"><i class="ri-arrow-left-circle-fill" style="font-size: 80px; position:relative ; top:100px;left:1300px"></i></a>

 <a class="btn btn-danger"><form action="{{ path('users_data_excel') }}" method="get">
    <i class="ri-arrow-left-circle-fill" style=" position:relative ; top:160px;left:750%"><button type="submit" class="btn btn-danger">Télécharger excel</button></i>
</form> </a>

<div class="row">
 <div  style="display: flex;align-items: center;justify-content: center;margin-top: 40px; margin-left:400px;padding:5px; width:1000px;">
            
<i class="i-"></i>
              <!-- Table with stripped rows -->
              <table class="table table-striped">
                <thead>
               
                                 {% for rapport in b %} 

    <tr>
   <th>num_rapport</th>
   <td>{{rapport.getId()}}</td>
    </tr>
    <tr>

   <th>date_rapport</th>
   <td>{{ rapport.getDateRapport|date('Y-m-d') }}</td>
       </tr>
           <tr>
   <th>num_serievoiture</th>
   <td>{{rapport.getNumSerievoiture()}}</td>
       </tr>
    <tr>
   <th>modele_voiture</th>
   <td>{{rapport.getModeleVoiture()}}</td>
       </tr>
    <tr>
   <th>matricule</th>
   <td>{{rapport.getMatricule()}}</td>
       </tr>
    <tr>

<th>couleur_voiture</th>
<td>{{rapport.getCouleurVoiture()}}</td>
    </tr>
    <tr>
   <th>dateMiseEnCirculation</th>
   <td>{{ rapport.getDateMiseEnCirculation|date('Y-m-d') }}</td>

       </tr>
    <tr>
<th> mandant</th>    
<td>{{rapport.getMandant()}}</td>
</tr>
  
    <tr>

   <th> conclusions</th>
   <td class="hidden-column">{{rapport.getConclusions()}}</td>
       </tr>
    <tr>
<th>photo</th> 
<td>
            {% if rapport.file is defined and rapport.file %}
                <a href="{{ asset('uploads/files/' ~ rapport.file) }}" target="_blank">
                    <button type="button" class="btn btn-warning">{{ rapport.file }}</button>
                </a>
            {% else %}
                Aucun fichier
            {% endif %}
        </td> 
        </tr>
        <tr>
   <th> montant_exprime</th>
   <td class="hidden-column">{{rapport.getMontantExprime()}}</td>
       </tr>
    <tr>
<th> etat_rapport</th>
   {% if rapport. getEtatRapport()=='Traitée'  %}
                    <td><img src="{{ asset('assets/img/check.png') }}" height="40" width="40"></td>
                {% elseif rapport. getEtatRapport()=='En attente' %}
                    <td><img src="{{ asset('assets/img/wait.png') }}" height="50" width="50"></td>
                {% else %}
                    <td><img src="{{ asset('assets/img/loading.png') }}" height="40" width="40"></td>
                {% endif %}
    </tr>
        <tr>

   <th>id_expert </th> 
<td class="hidden-column">{{rapport.getIdExpert()}}</td> 
       </tr>
  
             



<td class="hidden-column">
 <a class="btn btn-warning" href="{{ path('modifierrapport',{'id':rapport.getId()})}}"><img src="{{ asset('assets/img/update.png') }}" height="35" width="35"></a>
</td>
<td class="hidden-column">
 <a class="btn btn-danger"href="{{ path('supprimerrapport',{'id':rapport.getId()})}}"onclick="return confirm('Êtes-vous sûr de vouloir supprimer cette Rapport ?')"><img src="{{ asset('assets/img/delete.png') }}" height="30" width="30"></a>
</td>
<td class="hidden-column">
 <a class="btn btn-danger"><form action="{{ path('users_dataa') }}" method="get">
    <input type="hidden" name="id" value="{{ rapport.getId() }}">
    <button type="submit" class="btn btn-danger">Télécharger pdf</button>
</form> </a>
</td>

<td class="hidden-column">
<!-- bouton de téléchargement -->


    
    </td>
    <td class="hidden-column">
<!-- bouton de téléchargement -->
 <a href="{{ path('app_qr_codes', {'id': rapport.id}) }}" class="btn btn-danger">QrCode</a>

<!-- balise img pour afficher le QR code -->


    </td>
</tr>
{% endfor %}
                  
                 
                </tbody>
              </table>
             

           

 </div>
</div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
    </script>
    <script>
        $( document ).ready(function() {
            $("#search").keyup(function(e){
                /* La variable value va prendre la valeur insérer dans le champ de texte afin d’effectuer la recherche */
                var value = $(this).val();
                /* Ajax est lancé lors du remplissage du champ texte dont l’id est « search » pour faire la recherche */

                $.ajax({
                    /* l’url est une chaine de caractères contenant l’adresse où la requête est envoyée */
                    url : "{{ path('searchremb') }}",
                    /* La méthode utilisée pour transférer les données est GET */
                    type : 'GET',
                    /*Ici search value va prendre la chaine entrée par un utilisateur dans la zone de recherche et sera placée après l’url */
                    data: {
                        'search' : value
                    },
                    /*Cette fonction permet de vider le contenu du tableau pour recevoir le nouveau contenu*/
                    success : function(retour){
                        if(retour){
                            $('#t tbody#search').empty();
                            $.each(JSON.parse(retour), function(i, obj) {
                                $('#t tbody#all').hide();

                                $('#t tbody#search').append('<tr><td> '+obj.id+'</td><td>'+obj.getDateRapport+'</td><td>'+obj.getNumSerievoiture()+'</td><td>'+obj.dateconstat+'</td><td>'+obj.imageaccident+'</td><td>'+obj.etat+'</td><td><a href="/constat/'+obj.id+'/edit">Modifier</a></td></tr>');
                            });
                        }
                        else
                        {
                            $('#t tbody#all').show();
                            $('#t tbody#search').empty();
                            $('#t tbody#search').fadeIn('fast');
                        }
                    },
                });
                return false;
            });
        });
    </script>
{% endblock %}
